                                     ;==================================
; Script Name: Gravisoft's Animal Tamer
; Author: Gravix
; Version: 1.0
; Client Tested with: 4.0.6a
; EUO version tested with: 1.42.009D
; Shard OSI / FS: Both (May have issues with some FS)
; Revision Date: Unrevised
; Public Release: 12/26/04
; Global Variables Used: None
; Purpose: Follow, tame, retame, rename, release animals of your choice.
; Works with animals of all shapes and sizes!
;==================================


;================
;Customize
;================
SET %tamewait 12  ;Default is 12 (seconds) before considered timeout.
SET %hidetamed 0  ;Hide animals that have been tamed, Default is 0 (Needs work)
SET %_rename 0  ;Set to 1 to rename tamed animals
SET %name zwierze  ;Name to rename tamed animal to (Will come out all caps)
SET %_release 0  ;Auto release of animal.  Only works if rename is on.  Set to 0 if you wish to kill the animal yourself.


initEvents
;DISPLAY OK Welcome to Gravisoft's Animal Tamer v1.0
;WAIT 5
;EVENT MACRO 9 2
;WAIT 5
;EVENT MACRO 8 2
;WAIT 5
;EVENT MACRO 10 2
GOTO top


;================
;Retame Sub
;================
SUB retame

	EVENT SysMessage Starting retame cycle...
	SET #TARGCURS 0
	SET #LTARGETID %anid
	GOSUB follow
	WAIT 5
	EVENT MACRO 13 35
	TARGET 5s
check:
	IF #TARGCURS <> 1
	{
		WAIT 1s
		GOTO check
	}
	EVENT MACRO 22 0

RETURN

;================
;Rename Sub
;================
SUB rename

	EVENT SysMessage Starting raname cycle...
	SET %adj 0
	;Check pet loyalty
	FOR %i 1 3
	{
		EVENT MACRO 3 0 Podzajcie za mna
		WAIT 5
	}

 	WAIT 2s   ;Give it time to walk over
	EVENT MACRO 3 0 Stop

match:
	FindItem %anid
	IF #FINDX <> #CHARPOSX || #FINDY <> #CHARPOSY
	{
		EVENT PATHFIND #FINDX #FINDY #FINDZ
		WAIT 10
		GOTO match
	}
	else
	{
		WAIT 10
		EVENT SysMessage Searching for name gump...
adjust:

		savePix #CURSORX #CURSORY 1
		SET %clk 300 - %adj
		CLICK 390 %clk G
		WAIT 3
		savePix #CURSORX #CURSORY 2
		CLICK 390 %clk P
		WAIT 5
		IF #PIXCOL <> 10853433
		{
			WAIT 5
			EVENT MACRO 10 2
			WAIT 5
			SET #CONTPOSX 16
			SET #CONTPOSY 16
			IF %adj > 60
			{
				EVENT SysMessage Nie udalo sie zmienic nazwy. Zrob to recznie
				GOTO release
			}
			SET %adj %adj + 10
			WAIT 10
			GOTO match
		}
		SET #CONTPOSX 200
		SET #CONTPOSY 200
nameit:
		SET %clickx #CONTPOSX + 130
		SET %clicky #CURSORY + 20
		WAIT 1s
		CLICK 330 220
		WAIT 5

		FOR %i 1 20
		{
			KEY BACK
			WAIT 1
		}
		WAIT 1s
		MSG %name $
		WAIT 1
		FOR %i 10 1
		{
			WAIT 1
			IF #SYSMSG <> NA
				GOTO endname
		{
		GOTO nameit
endname:
		CLICK 330 220 R
		RETURN
	}
RETURN

;================
;Release Sub
;================
SUB release
	WAIT 5
	MSG %name uwalniam cie $
	GOTO release
RETURN

;================
;Follow Sub
;================
SUB follow
	FindItem %anid
	IF #FINDX <> #CHARPOSX || #FINDY <> #CHARPOSY
	{
		EVENT PATHFIND #FINDX #FINDY #FINDZ
		WAIT 20
	}
RETURN


;================
;Start
;================
top:
	DeleteJournal
	SET #LTARGETID #CHARID
	SET %waited 0
	SET %fol #FOLLOWERS
	SET %find 0
	IF #TARGCURS = 1
		SET #TARGCURS 0
	EVENT MACRO 13 35
	TARGET 5s



wait:
	ONHOTKEY ESC
		GOTO die
	IF #TARGCURS = 1
		GOTO wait
	WAIT 10
	FOR %i 5 1
	{
		ScanJournal %i
		IF Jakie_mile_stworzenie_ in #journal
			GOTO out
		DeleteJournal
	}
	GOTO top

out:
	SET %anid #LTARGETID
	SET %stt #SCNT

taming:

	SET %tp %stt - #SCNT
	GOSUB follow

	FOR %i 5 1
	{
		ScanJournal %i

		IF Nie_udalo_ in #journal || the_animal_has_been in #journal || %tp > %tamewait
			GOSUB retame

;		IF %fol <> #FOLLOWERS
    IF Twoim_nowym_przyjacielem_ in #journal
		GOTO tamed

		DeleteJournal
	}


	GOTO taming

tamed:
	MSG Podarzajcie za mna$
	WAIT 5
	EVENT ExMsg #CHARID 3 87 Oswoilem zwierze!
	MSG Uwalniam was$
	IF %_rename = 1
	{
		GOSUB rename
		IF %_release = 1
			GOSUB release
	}
	EVENT ExMsg #CHARID 3 87 Please release/kill tamed animal to tame another.

release:
	IF %fol < #FOLLOWERS
		GOTO release

	WAIT 30
	IF %hidetamed = 1
	{
		hideItem %anid
		EVENT SysMessage Animal hidden.
	}
	EVENT ExMsg #charID 3 87 Target next animal.
	GOTO top

die:
	EVENT ExMsg #charID 3 87 Thank you for using Gravisoft's Animal Tamer v1.0
	HALT
